{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ryana\\\\csc307\\\\CSC307-Receipt-App\\\\packages\\\\frontend\\\\src\\\\ImageCapture.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useState } from 'react';\nimport axios from 'axios';\nimport './CSS Files/ImageCapture.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ImageCapture = () => {\n  _s();\n  const [image, setImage] = useState(null);\n  const [isWebcamActive, setIsWebcamActive] = useState(false);\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const [file, setFile] = useState(null);\n  const captureImage = () => {\n    const context = canvasRef.current.getContext('2d');\n    canvasRef.current.width = videoRef.current.videoWidth;\n    canvasRef.current.height = videoRef.current.videoHeight;\n    context.drawImage(videoRef.current, 0, 0, videoRef.current.videoWidth, videoRef.current.videoHeight);\n    const imageDataUrl = canvasRef.current.toDataURL('image/png');\n    setImage(imageDataUrl);\n    setIsWebcamActive(false);\n  };\n  const handleFileUpload = async () => {\n    const formData = new FormData();\n    formData.append('file', file);\n    try {\n      const token = localStorage.getItem('token');\n      console.log(token);\n      await fetch('http://localhost:8000/upload', {\n        method: 'POST',\n        body: formData,\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      const userConfirmed = window.confirm('File uploaded successfully. Do you want to process this data?');\n      if (userConfirmed) {\n        const token = localStorage.getItem('token');\n        const requestOptions = {\n          method: 'GET',\n          headers: {\n            'Content-Type': 'multipart/form-data',\n            Authorization: `Bearer ${token}` // Include the token in the Authorization header\n          }\n        };\n\n        fetch('http://localhost:8000/process', requestOptions).then(response => {\n          if (!response.ok) {\n            throw new Error(`HTTP error! Status: ${response.status}`);\n          }\n          return response.json();\n        }).then(data => {\n          console.log('File uploaded successfully:', data);\n        }).catch(error => {\n          console.error('Error uploading file:', error.message);\n        });\n      }\n    } catch (error) {\n      console.error('Error uploading file:', error);\n    }\n    console.log('File uploaded successfully');\n  };\n  const startVideo = () => {\n    navigator.mediaDevices.getUserMedia({\n      video: true\n    }).then(stream => {\n      videoRef.current.srcObject = stream;\n      setIsWebcamActive(true);\n    }).catch(err => {\n      console.error('Error accessing webcam:', err);\n      setIsWebcamActive(false);\n    });\n  };\n  const retakeImage = () => {\n    setImage(null);\n    startVideo();\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"file-upload-container\",\n    children: [!image && /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      autoPlay: true,\n      playsInline: true,\n      width: \"640\",\n      height: \"480\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 24\n    }, this), isWebcamActive && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"button\",\n      onClick: captureImage,\n      children: \"Capture\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 32\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      width: \"640\",\n      height: \"480\",\n      style: {\n        display: 'none'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 13\n    }, this), image && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: image,\n        alt: \"Captured\",\n        width: \"640\",\n        height: \"480\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"button\",\n        onClick: retakeImage,\n        children: \"Retake\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: 'upload',\n        onClick: handleFileUpload,\n        children: \"Upload\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }, this), !isWebcamActive && !image && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"button\",\n      onClick: startVideo,\n      children: \"Start Webcam\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 43\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 96,\n    columnNumber: 9\n  }, this);\n};\n_s(ImageCapture, \"kIwDBxdp+jlltsE2xGuXS+5mdPw=\");\n_c = ImageCapture;\nexport default ImageCapture;\nvar _c;\n$RefreshReg$(_c, \"ImageCapture\");","map":{"version":3,"names":["React","useRef","useState","axios","jsxDEV","_jsxDEV","ImageCapture","_s","image","setImage","isWebcamActive","setIsWebcamActive","videoRef","canvasRef","file","setFile","captureImage","context","current","getContext","width","videoWidth","height","videoHeight","drawImage","imageDataUrl","toDataURL","handleFileUpload","formData","FormData","append","token","localStorage","getItem","console","log","fetch","method","body","headers","userConfirmed","window","confirm","requestOptions","Authorization","then","response","ok","Error","status","json","data","catch","error","message","startVideo","navigator","mediaDevices","getUserMedia","video","stream","srcObject","err","retakeImage","className","children","ref","autoPlay","playsInline","fileName","_jsxFileName","lineNumber","columnNumber","onClick","style","display","src","alt","_c","$RefreshReg$"],"sources":["C:/Users/ryana/csc307/CSC307-Receipt-App/packages/frontend/src/ImageCapture.js"],"sourcesContent":["import React, { useRef, useState } from 'react';\r\nimport axios from 'axios';\r\nimport './CSS Files/ImageCapture.css';\r\n\r\n\r\nconst ImageCapture = () => {\r\n    const [image, setImage] = useState(null);\r\n    const [isWebcamActive, setIsWebcamActive] = useState(false);\r\n    const videoRef = useRef(null);\r\n    const canvasRef = useRef(null);\r\n    const [file, setFile] = useState(null);\r\n\r\n\r\n\r\n    const captureImage = () => {\r\n        const context = canvasRef.current.getContext('2d');\r\n        canvasRef.current.width = videoRef.current.videoWidth;\r\n        canvasRef.current.height = videoRef.current.videoHeight;\r\n        context.drawImage(videoRef.current, 0, 0, videoRef.current.videoWidth, videoRef.current.videoHeight);\r\n        const imageDataUrl = canvasRef.current.toDataURL('image/png');\r\n        setImage(imageDataUrl);\r\n        setIsWebcamActive(false);\r\n    };\r\n\r\n\r\n    const handleFileUpload = async () => {\r\n        const formData = new FormData();\r\n        formData.append('file', file);\r\n\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            console.log(token);\r\n            await fetch('http://localhost:8000/upload', {\r\n                method: 'POST',\r\n                body: formData,\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`,\r\n                },\r\n            });\r\n\r\n            const userConfirmed = window.confirm('File uploaded successfully. Do you want to process this data?');\r\n\r\n            if (userConfirmed) {\r\n                const token = localStorage.getItem('token');\r\n\r\n                const requestOptions = {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Content-Type': 'multipart/form-data',\r\n                        Authorization: `Bearer ${token}`, // Include the token in the Authorization header\r\n                    },\r\n                };\r\n\r\n                fetch('http://localhost:8000/process', requestOptions)\r\n                    .then((response) => {\r\n                        if (!response.ok) {\r\n                            throw new Error(`HTTP error! Status: ${response.status}`);\r\n                        }\r\n                        return response.json();\r\n                    })\r\n                    .then((data) => {\r\n                        console.log('File uploaded successfully:', data);\r\n\r\n                    })\r\n                    .catch((error) => {\r\n                        console.error('Error uploading file:', error.message);\r\n                    });\r\n            }\r\n        } catch (error) {\r\n            console.error('Error uploading file:', error);\r\n        }\r\n            console.log('File uploaded successfully');\r\n    };\r\n\r\n\r\n    const startVideo = () => {\r\n        navigator.mediaDevices.getUserMedia({ video: true })\r\n            .then(stream => {\r\n                videoRef.current.srcObject = stream;\r\n                setIsWebcamActive(true);\r\n            })\r\n            .catch(err => {\r\n                console.error('Error accessing webcam:', err);\r\n                setIsWebcamActive(false);\r\n            });\r\n    };\r\n\r\n\r\n    const retakeImage = () => {\r\n        setImage(null);\r\n        startVideo();\r\n    };\r\n\r\n\r\n    return (\r\n        <div className=\"file-upload-container\">\r\n            {!image && <video ref={videoRef} autoPlay playsInline width=\"640\" height=\"480\" />}\r\n            {isWebcamActive && <button className=\"button\" onClick={captureImage}>Capture</button>}\r\n            <canvas ref={canvasRef} width=\"640\" height=\"480\" style={{ display: 'none' }}></canvas>\r\n            {image && (\r\n                <div>\r\n                    <img src={image} alt=\"Captured\" width=\"640\" height=\"480\" />\r\n                    <button className=\"button\" onClick={retakeImage}>Retake</button>\r\n                    <button className={'upload'} onClick={handleFileUpload}>Upload</button>\r\n                </div>\r\n            )}\r\n            {!isWebcamActive && !image && <button className=\"button\" onClick={startVideo}>Start Webcam</button>}\r\n        </div>\r\n    );\r\n};\r\n\r\n\r\nexport default ImageCapture;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}